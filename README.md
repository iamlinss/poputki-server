# Программное средство реализации онлайн-сервиса организации совместных автомобильных поездок по РБ и РФ
Цель работы – разработка приложения, позволяющего пользователям находить и организовывать совместные поездки на автомобиле.

[Макет дизайна Программного средства](https://www.figma.com/design/PQkgQu3JMsPId5t9dff724/%D0%94%D0%B8%D0%B7%D0%B0%D0%B9%D0%BD-%D0%B4%D0%B8%D0%BF%D0%BB%D0%BE%D0%BC?node-id=0-1&node-type=canvas&t=rwB2GEdUHnWTJIzY-0)

В системе Попутки реализована интеграция нескольких ключевых веб-приложений и серверного приложения. Система предназначена для упрощения процесса совместных поездок и оптимизации взаимодействия между пассажирами и водителями. Она включает в себя два основных веб-приложения: Пассажир, Водитель.

[C4 Container](https://github.com/iamlinss/poputki-server/blob/master/doc/C4%20-%20Container.jpg)

***Web-приложение Popytki Driver*** предназначено для управления процессами водителей, позволяя им принимать заказы на совместные поездки, отслеживать свои маршруты, взаимодействовать с пассажирами через встроенные чаты и управлять своими рейтингами и отзывами.<br />
***Web-приложение Popytki Client*** предназначено для предоставления пользователям возможности искать и бронировать совместные поездки, взаимодействовать с водителями, отслеживать статус своих бронирований и оценивать качество поездок, создавая удобный и интуитивно понятный интерфейс для планирования путешествий.<br />
***Приложение Backend Popytki*** предназначено для обработки бизнес-логики и управления данными в системе совместных поездок. Оно обеспечивает взаимодействие между клиентскими приложениями и базами данных, обрабатывает запросы пользователей, управляет аутентификацией и авторизацией, а также выполняет операции по созданию, обновлению и удалению поездок и бронирований


[C4 Component](https://github.com/iamlinss/poputki-server/blob/master/doc/C4%20-%20Component.jpg)

Веб-приложения Popytki Driver, Popytki Client являются пользовательскими интерфейсами, взаимодействующими с сервером через REST API (JSON/HTTPS).

[Диаграмма классов](https://github.com/iamlinss/Popytki/blob/main/doc/class.png)

<br />Приложения, созданные с помощью принципов чистой архитектуры, обладают высокой устойчивостью к изменениям. Они быстро адаптируются к новым требованиям и возможностям, сохраняя при этом высокое качество кода и производительность. Кроме того, система становится гораздо проще для понимания и сопровождения, что делает ее более доступной для других разработчиков.
Принципы чистой архитектуры также помогают избежать проблем с зависимостями и разделить приложение на логические блоки. Это повышает удобство добавления новых функций и изменения уже существующих. В результате, время разработки сокращается, а приложение становится более гибким и масштабируемым.<br />
<br />Clean Architecture состоит из нескольких принципов, которые помогают разработчикам создавать качественное и устойчивое программное обеспечение.<br />
<br />Ключевой принцип Clean Architecture – разделение приложения на уровни, каждый из которых выполняет свои задачи и управляет своей ответственностью. Обычно такое разделение выглядит следующим образом:<br />
* Интерфейс пользователя (UI): отвечает за взаимодействие с пользователем.
* Представление (Presentation): отображает данные и обрабатывает пользовательский ввод.
* Приложение (Application): содержит бизнес-логику и оркестрирует взаимодействие между различными компонентами системы.
* Домен (Domain): содержит ядро системы и включает в себя основную бизнес-логику и модели данных.
* Инфраструктура (Infrastructure): предоставляет реализации абстракций, таких как базы данных, внешние сервисы и т.д.

## Архитектура

[ERD](https://github.com/iamlinss/Popytki/blob/main/doc/drawSQL-image-export-2024-10-02.png) <br />
<br />Диаграмма сущностей и связей (ERD) для базы данных включает несколько ключевых сущностей, таких как Пользователь (User), Поездка (Trip), Заявка на поездку (Booking), Рейтинг (Rating), Чат (Chat) и Сообщение (Message). Эти сущности и их атрибуты обеспечивают основные функции веб-приложения для поиска попутчиков.
Каждая сущность имеет свои атрибуты, включая уникальные идентификаторы, которые служат первичными ключами (PK), и другие атрибуты, хранящие различные данные.

[Диаграмма состояний](https://github.com/iamlinss/poputki-server/blob/master/doc/%D0%94%D0%B8%D0%B0%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B0%20%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D0%B9.drawio.png) <br />
<br />В качестве объекта, возьмем “Бронь поездки”. В нашем случае, у объекта “Бронь поездки” будет несколько состояний – Создана, Подтверждена, Отменена пассажиром и Отклонена водителем.

[Диаграмма последовательности](https://github.com/iamlinss/poputki-server/blob/master/doc/%D0%94%D0%B8%D0%B0%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B0%20%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8.jpg) <br />
<br />В нашем случае, рассмотрим процесс “Бронирование совместной автомобильной поездки”. В этом случае объекты это: Пассажир (пользователь ПС), UI (интерфейс пользователя – клиентская часть приложения), Сервис поездок (классы ПС, отвечающие за логику работы с поездками), Сервис бронирования (классы ПС, отвечающие за логику работы с бронями поездок) и БД (хранилище информации ПС).

[Диаграмма вариантов использования](https://github.com/iamlinss/poputki-server/blob/master/doc/%D0%92%D0%B0%D1%80%D0%B8%D0%B0%D0%BD%D1%82%D0%BE%D0%B2%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F.drawio.png) <br />
<br />С помощью диаграммы вариантов использования мы сможем проследить различные пути взаимодействия пользователей с программным средством, выявить ключевые функции, оптимизировать процессы бронирования поездок и повысить удовлетворенность пользователей. Предлагаемый инструмент не только облегчит планирование поездок, но и способствует созданию удобной и безопасной среды для сотрудничества и обмена опытом между участниками.

[Диаграмма развертывания](https://github.com/iamlinss/poputki-server/blob/master/doc/%D0%94%D0%B8%D0%B0%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B0%20%D1%80%D0%B0%D0%B7%D0%B2%D0%B5%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F.jpg) <br />
<br />Данная диаграмма демонстрирует многослойную архитектуру, где клиентская часть (браузеры) взаимодействует с серверной частью (веб-сервер и база данных). Все компоненты связаны через сетевые протоколы, обеспечивая эффективное взаимодействие пользователей с приложением.

[Схема алгоритма](https://github.com/iamlinss/poputki-server/blob/master/doc/%D0%A1%D1%85%D0%B5%D0%BC%D0%B0%20%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%D0%B0.jpg) <br />
<br />Бронирование поездки – важный алгоритм логики приложения. Важной особенностью алгоритма является обязательность выполнения условий проверки полученных данных в базе данных. Только при выполнении всех условий возможно организовать процесс бронирования поездки. 

## Пользовательский интерфейс 
### User flow диаграммы

[Пассажир](https://github.com/iamlinss/Popytki/blob/main/doc/user%20flow%20(%D0%9F%D0%B0%D1%81%D1%81%D0%B0%D0%B6%D0%B8%D1%80).png)

[Водитель](https://github.com/iamlinss/Popytki/blob/main/doc/user%20flow%20(%D0%92%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C).png)

### Примеры экранов UI
https://www.figma.com/design/PQkgQu3JMsPId5t9dff724/%D0%94%D0%B8%D0%B7%D0%B0%D0%B9%D0%BD-%D0%B4%D0%B8%D0%BF%D0%BB%D0%BE%D0%BC?node-id=274-844&p=f&t=PdSZvJdwk9HkQRfl-0 

## Развёртывание

Для развёртывания приложения доступно два подхода: с использованием Docker и без него. Ниже описаны оба метода.

### Развёртывание с использованием Docker

1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/iamlinss/poputki-server.git
   cd poputki-server
   ```

2. **Перейдите к директории с Dockerfile**:
   ```bash
   cd poputka-api
   ```

3. **Постройте Docker-образ**:
   ```bash
   docker build -t poputki-server .
   ```

4. **Запустите контейнер с передачей параметров подключения к базе данных**:
   ```bash
   docker run -d -p 8080:8080 \
     -e SPRING_DATASOURCE_URL=jdbc:postgresql://<ваш-хост>:<ваш-порт>/<ваша-база> \
     -e SPRING_DATASOURCE_USERNAME=<ваш-юзер> \
     -e SPRING_DATASOURCE_PASSWORD=<ваш-пароль> \
     --name poputki-server poputki-server
   ```

5. **Проверьте работу приложения**:
   Перейдите в браузере по адресу [http://localhost:8080](http://localhost:8080).

### Развёртывание без использования Docker

1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/iamlinss/poputki-server.git
   cd poputki-server
   ```

2. **Настройте параметры подключения к базе данных**:
   Отредактируйте файл `application.properties`, расположенный по пути:
   ```
   poputka-api/src/main/resources/application.properties
   ```
   Убедитесь, что строки с параметрами подключения выглядят корректно:
   ```properties
   spring.datasource.url=jdbc:postgresql://<ваш-хост>:<ваш-порт>/<ваша-база>
   spring.datasource.username=<ваш-юзер>
   spring.datasource.password=<ваш-пароль>
   ```

3. **Соберите проект**:
   Убедитесь, что у вас установлен Maven, затем выполните:
   ```bash
   cd poputka-api
   mvn clean package
   ```

4. **Запустите приложение**:
   ```bash
   java -jar target/poputka-v1.jar
   ```

5. **Проверьте работу приложения**:
   Перейдите в браузере по адресу [http://localhost:8080](http://localhost:8080).
